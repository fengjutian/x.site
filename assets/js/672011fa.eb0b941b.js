"use strict";(self.webpackChunkx_site=self.webpackChunkx_site||[]).push([[2929],{1865:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>o,default:()=>h,frontMatter:()=>s,metadata:()=>i,toc:()=>d});var r=n(4848),a=n(8453);const s={sidebar_position:2},o="URL Dispatch",i={id:"actix/advanced/URL-Dispatch",title:"URL Dispatch",description:"URL dispatch provides a simple way for mapping URLs to handler code using a simple pattern matching language. If one of the patterns matches the path information associated with a request, a particular handler object is invoked.",source:"@site/docs/actix/advanced/URL-Dispatch.md",sourceDirName:"actix/advanced",slug:"/actix/advanced/URL-Dispatch",permalink:"/x.site/docs/actix/advanced/URL-Dispatch",draft:!1,unlisted:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/actix/advanced/URL-Dispatch.md",tags:[],version:"current",sidebarPosition:2,frontMatter:{sidebar_position:2},sidebar:"actixSidebar",previous:{title:"Errors",permalink:"/x.site/docs/actix/advanced/Errors"},next:{title:"Requests",permalink:"/x.site/docs/actix/advanced/Requests"}},c={},d=[{value:"Configuring a Route",id:"configuring-a-route",level:2}];function u(e){const t={code:"code",h1:"h1",h2:"h2",li:"li",p:"p",pre:"pre",ul:"ul",...(0,a.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t.h1,{id:"url-dispatch",children:"URL Dispatch"}),"\n",(0,r.jsx)(t.p,{children:"URL dispatch provides a simple way for mapping URLs to handler code using a simple pattern matching language. If one of the patterns matches the path information associated with a request, a particular handler object is invoked."}),"\n",(0,r.jsx)(t.h1,{id:"resource-configuration",children:"Resource configuration"}),"\n",(0,r.jsxs)(t.p,{children:["Resource configuration is the act of adding a new resources to an application. A resource has a name, which acts as an identifier to be used for URL generation. The name also allows developers to add routes to existing resources. A resource also has a pattern, meant to match against the PATH portion of a URL (the portion following the scheme and port, e.g. ",(0,r.jsx)(t.code,{children:"/foo/bar"})," in the URL ",(0,r.jsx)(t.code,{children:"http://localhost:8080/foo/bar?q=value"}),"). It does not match against the QUERY portion (the portion that follows ?, e.g. q=value in ",(0,r.jsx)(t.code,{children:"http://localhost:8080/foo/bar?q=value"}),")."]}),"\n",(0,r.jsxs)(t.p,{children:["The ",(0,r.jsx)(t.code,{children:"App::route()"})," method provides simple way of registering routes. This method adds a single route to application routing table. This method accepts a path pattern, HTTP method and a handler function. ",(0,r.jsx)(t.code,{children:"route()"})," method could be called multiple times for the same path, in that case, multiple routes register for the same resource path."]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-rust",children:'use actix_web::{web, App, HttpResponse, HttpServer};\n\nasync fn index() -> HttpResponse {\n    HttpResponse::Ok().body("Hello")\n}\n\n#[actix_web::main]\nasync fn main() -> std::io::Result<()> {\n    HttpServer::new(|| {\n        App::new()\n            .route("/", web::get().to(index))\n            .route("/user", web::post().to(index))\n    })\n    .bind(("127.0.0.1", 8080))?\n    .run()\n    .await\n}\n'})}),"\n",(0,r.jsxs)(t.p,{children:["While ",(0,r.jsx)(t.code,{children:"App::route()"})," provides simple way of registering routes, to access complete resource configuration, a different method has to be used. The ",(0,r.jsx)(t.code,{children:"App::service()"})," method adds a single resource to application routing table. This method accepts a path pattern, guards, and one or more routes."]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-rust",children:'use actix_web::{guard, web, App, HttpResponse};\n\nasync fn index() -> HttpResponse {\n    HttpResponse::Ok().body("Hello")\n}\n\npub fn main() {\n    App::new()\n        .service(web::resource("/prefix").to(index))\n        .service(\n            web::resource("/user/{name}")\n                .name("user_detail")\n                .guard(guard::Header("content-type", "application/json"))\n                .route(web::get().to(HttpResponse::Ok))\n                .route(web::put().to(HttpResponse::Ok)),\n        );\n}\n'})}),"\n",(0,r.jsx)(t.p,{children:"If a resource does not contain any route or does not have any matching routes, it returns NOT FOUND HTTP response"}),"\n",(0,r.jsx)(t.h2,{id:"configuring-a-route",children:"Configuring a Route"}),"\n",(0,r.jsxs)(t.p,{children:["Resource contains a set of routes. Each route in turn has a set of guards and a handler. New routes can be created with ",(0,r.jsx)(t.code,{children:"Resource::route()"})," method which returns a reference to new Route instance. By default the route does not contain any guards, so matches all requests and the default handler is ",(0,r.jsx)(t.code,{children:"HttpNotFound"}),"."]}),"\n",(0,r.jsxs)(t.p,{children:["The application routes incoming requests based on route criteria which are defined during resource registration and route registration. Resource matches all routes it contains in the order the routes were registered via ",(0,r.jsx)(t.code,{children:"Resource::route()"}),"."]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-rust",children:'App::new().service(\n    web::resource("/path").route(\n        web::route()\n            .guard(guard::Get())\n            .guard(guard::Header("content-type", "text/plain"))\n            .to(HttpResponse::Ok),\n    ),\n)\n'})}),"\n",(0,r.jsxs)(t.p,{children:["In this example, ",(0,r.jsx)(t.code,{children:"HttpResponse::Ok()"})," is returned for GET requests if the request contains Content-Type header, the value of this header is text/plain, and path equals to /path."]}),"\n",(0,r.jsx)(t.p,{children:'If a resource can not match any route, a "NOT FOUND" response is returned.'}),"\n",(0,r.jsx)(t.p,{children:"ResourceHandler::route() returns a Route object. Route can be configured with a builder-like pattern. Following configuration methods are available:"}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsxs)(t.li,{children:[(0,r.jsx)(t.code,{children:"Route::guard()"})," registers a new guard. Any number of guards can be registered for each route."]}),"\n",(0,r.jsxs)(t.li,{children:[(0,r.jsx)(t.code,{children:"Route::method()"})," registers a method guard. Any number of guards can be registered for each route."]}),"\n",(0,r.jsxs)(t.li,{children:[(0,r.jsx)(t.code,{children:"Route::to()"})," registers an async handler function for this route. Only one handler can be registered. Usually handler registration is the last config operation."]}),"\n"]}),"\n",(0,r.jsx)(t.h1,{id:"route-matching",children:"Route matching"}),"\n",(0,r.jsx)(t.p,{children:"The main purpose of route configuration is to match (or not match) the request's path against a URL path pattern. path represents the path portion of the URL that was requested."}),"\n",(0,r.jsx)(t.p,{children:"The way that actix-web does this is very simple. When a request enters the system, for each resource configuration declaration present in the system, actix checks the request's path against the pattern declared. This checking happens in the order that the routes were declared via App::service() method. If resource can not be found, the default resource is used as the matched resource."}),"\n",(0,r.jsx)(t.p,{children:"When a route configuration is declared, it may contain route guard arguments. All route guards associated with a route declaration must be true for the route configuration to be used for a given request during a check. If any guard in the set of route guard arguments provided to a route configuration returns false during a check, that route is skipped and route matching continues through the ordered set of routes."}),"\n",(0,r.jsx)(t.p,{children:"If any route matches, the route matching process stops and the handler associated with the route is invoked. If no route matches after all route patterns are exhausted, a NOT FOUND response get returned."})]})}function h(e={}){const{wrapper:t}={...(0,a.R)(),...e.components};return t?(0,r.jsx)(t,{...e,children:(0,r.jsx)(u,{...e})}):u(e)}},8453:(e,t,n)=>{n.d(t,{R:()=>o,x:()=>i});var r=n(6540);const a={},s=r.createContext(a);function o(e){const t=r.useContext(s);return r.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function i(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:o(e.components),r.createElement(s.Provider,{value:t},e.children)}}}]);